- name: Test local action copy
  hosts: all
  tasks:
  - name: Generate join command
    command: echo "echo hello world"
    register: join_command
    
  - name: Copy join command to local file
    local_action: copy content="{{ join_command.stdout_lines[0] }}" dest="/tmp/join-command"
  
  - name: Copy the join command to server location
    copy: 
      src: /tmp/join-command 
      dest: /tmp/join-command.sh 
      mode: 0777
  
  - name: Join the node to cluster
    command: sh /tmp/join-command.sh